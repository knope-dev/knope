# CreateChangeFile step

A "change file" is a specially formatted Markdown file that is used both to determine the next version of your project and to generate a changelog. This step will interactively create a new change file in the `.changeset` directory of your project (creating that directory if missing). When a [`PrepareRelease`] step runs, it will combine both change files and any [conventional commits] since the last release to generate changelogs and update versions for any configured [packages].

## Example

```admonish note
The [default workflows] include an `document-change` workflow that will run this step for you. If you do not already have a `knope.toml` file, you do not need to create one to use this feature.
```

With a `knope.toml` file that looks like this:

```toml
[packages.first]
versioned_files = ["first/Cargo.toml"]
changelog = "first/CHANGELOG.md"
extra_changelog_sections = [
  { name = "Warning âš ï¸", types = ["warn"] }
]

[packages.second]
versioned_files = ["second/Cargo.toml"]
changelog = "second/CHANGELOG.md"
extra_changelog_sections = [
  { name = "Poems ðŸŽ­", types = ["poem"] }
]

[[workflows]]
name = "document-change"

[[workflows.steps]]
type = "CreateChangeFile"
```

You could run `knope document-change` to start a new change file. First, you will be prompted to select the packages that this change affects, for this example, we check off both packages.

```markdown
- [x] first
- [x] second
```

```admonish note
If there is only one package, this step is skipped and a special, default package is automatically selected. This is the case when you do not have a `knope.toml` file.
```

For each package, you will be prompted to select the type of change you are documenting. The available change types are "Breaking", "Feature", "Fix", and any of the custom types configured in `extra_changelog_sections.types`. For the `first` package, this will look like:

```
Enter the type for the `first` package:

Breaking
Feature
Fix
> warn
```

For the second, we could select the type "poem" instead of "warn". Next, you will be prompted write a short summary of the change (a few words). The summary will be used both as the name of the file and a header in the changelog generated by `PrepareRelease`.

Let's say we enter the summary "Ozymandias by Percy Shelley", this step will then generate a file `.changeset/ozymandias_by_percy_shelley.md` with the following contents:

```markdown
---
first: warn
second: poem
---

### Ozymandias by Percy Shelley
```

If that brief summary is not enough, you should then edit this file and add more detail below the generated heading, using all the Markdown features you want!

```markdown
---
first: warn
second: poem
---

### Ozymandias by Percy Shelley

I met a traveller from an antique land Who said: â€˜Two vast and trunkless legs of stone Stand in the desert. Near them, on the sand, Half sunk, a shattered visage lies, whose frown, And wrinkled lip, and sneer of cold command, Tell that its sculptor well those passions read Which yet survive, stamped on these lifeless things, The hand that mocked them and the heart that fed: And on the pedestal these words appear:

> My name is Ozymandias, king of kings: Look on my works, ye Mighty, and despair!

Nothing beside remains. Round the decay Of that colossal wreck, boundless and bare The lone and level sands stretch far away.â€™
```

When you are done, you can run `knope document-change` again to create another change file. When you are ready to release, run [`PrepareRelease`] to combine all the change files and conventional commits into a changelog and update the versions of any configured [packages]. The type of the change for each package will determine where it is placed in the changelog: so `first/CHANGELOG.md` will have a `## Warning âš ï¸` section and `second/CHANGELOG.md` will have a `## Poems ðŸŽ­` section, each containing the summary and body of the change.

For completeness, this is what the changelog for `second` would look like (if there had been no other changes):

```markdown
## Poems ðŸŽ­

### Ozymandias by Percy Shelley

I met a traveller from an antique land Who said: â€˜Two vast and trunkless legs of stone Stand in the desert. Near them, on the sand, Half sunk, a shattered visage lies, whose frown, And wrinkled lip, and sneer of cold command, Tell that its sculptor well those passions read Which yet survive, stamped on these lifeless things, The hand that mocked them and the heart that fed: And on the pedestal these words appear:

> My name is Ozymandias, king of kings: Look on my works, ye Mighty, and despair!

Nothing beside remains. Round the decay Of that colossal wreck, boundless and bare The lone and level sands stretch far away.â€™
```

[`PrepareRelease`]: ./PrepareRelease.md
[conventional commits]: https://www.conventionalcommits.org/en/v1.0.0/
[packages]: ../packages.md
[default workflows]: ../../default_workflows.md
