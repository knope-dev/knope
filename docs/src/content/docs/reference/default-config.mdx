---
title: "Default config"
---

import { Badge, FileTree } from "@astrojs/starlight/components";

Knope has some default configuration for things that aren't specified in a `knope.toml` file
(either when the file isn't present, or when there are missing sections).

To find out what _your project's_ default config is, use
`knope --generate` (with no `knope.toml` file in the current directory).

:::tip
Follow the [basics tutorial](/tutorials/releasing-basic-projects) to learn the default workflows hands-on.
:::

## Packages

When there are no packages defined in a `knope.toml` file, Knope tries to find supported packages automatically.

### Single package

Most of the time,
Knope will look for any [supported formats](/reference/config-file/packages#versioned_files) in the current directory
and add all of those to a single package:

```toml title="knope.toml"
[package]
versioned_files = ["Cargo.toml", "package.json", "deno.json"]
changelog = "CHANGELOG.md"
```

The `changelog` field is only set if there's a `CHANGELOG.md` file in the current directory.

If the directory also contains a `deno.lock` file for the detected package, Knope will automatically add it with the
correct `dependency` so lockfile entries stay aligned with releases.

### Cargo workspaces

If there's a `Cargo.toml` file in the current directory that looks like a Cargo workspace,
Knope will create a package for each member.

:::caution
Only a subset of Cargo workspace features are currently supported, notably members have to be explicitly listed, not using any `*`.
:::

```toml title="Cargo.toml"
[workspace]
members = ["member1", "member2"]
```

The names of these packages are from the `name` in their respective `Cargo.toml` files, not the directory name.
There _must_ be a `Cargo.toml` file in each member directory, or Knope will error.

Knope will also attempt to detect dependencies **by package name** between members and keep them up to date.

With a workspace like this:

```toml title="Cargo.toml"
[workspace]
members = ["member1", "member2"]

[workspace.dependencies]
something = { path = "member1" }
something-else = { path = "member2" }
```

```toml title="member1/Cargo.toml"
[package]
name = "something"
version = "1.0.0"

[dependencies]
something-else = { path = "../something-else", version = "0.1.0" }
```

```toml title="member2/Cargo.toml"
[package]
name = "something-else"
version = "0.1.0"
```

The default `knope.toml` file will look like this:

```toml title="Default knope.toml"
[packages.something]
versioned_files = [
    "member1/Cargo.toml",
    "Cargo.lock",
    { path = "Cargo.toml", dependency = "something" },
]
scopes = ["something"]

[packages.something-else]
versioned_files = [
    "member2/Cargo.toml",
    "Cargo.lock",
    { path = "Cargo.toml", dependency = "something-else" },
    { path = "member1/Cargo.toml", dependency = "something-else" },
]
scopes = ["something-else"]
```

### NPM Workspaces <Badge text="Knope 0.21.0+" variant="tip" />

If there's a `package.json` file in the current directory with `workspaces` defined, Knope will create a package for each
workspace.

```json title="package.json"
{ "workspaces": ["member1", "others/*"] }
```

The names of these packages are from the `name` in their respective `package.json` files, not the directory name.
Knope will also attempt to detect dependencies **by package name** between members and keep them up to date.

For the above `package.json` which defines workspaces, with this file tree:

{/* prettier-ignore */}
<FileTree>
  - package.json # Workspace
  - package-lock.json
  - member1/
    - package.json # name = "first", depends on "second"
  - others/
    - member2/ - package.json # name = "second"
  - anotherDir/
</FileTree>

The default `knope.toml` file will look something like this:

```toml title="Default knope.toml"
[packages.first]
versioned_files = [
    "member1/package.json",
    { path = "package-lock.json", dependency = "first" },
]
scopes = ["first"]

[packages.something-else]
versioned_files = [
    "others/member2/package.json",
    { path = "package-lock.json", dependency = "second" },
    { path = "member1/package.json", dependency = "second" },
]
scopes = ["second"]
```

### Deno workspaces

If there's a `deno.json` file in the current directory with a [`workspace`](https://docs.deno.com/runtime/reference/workspaces/)
array, Knope will create a package for each member that has both a `name` and a `version` in its `deno.json` (or `deno.jsonc`).
Any `package.json` files living alongside those manifests are also considered so mixed JSR/NPM modules stay aligned.

```json title="deno.json"
{
  "workspace": ["first", "packages/second"]
}
```

{/* prettier-ignore */}
<FileTree>
  - deno.json # Workspace
  - deno.lock
  - first/
    - deno.json # name = "@scope/first", depends on second
  - packages/
    - second/
      - deno.json # name = "@scope/second"
</FileTree>

For this layout, the default `knope.toml` file looks like:

```toml title="Default knope.toml"
[packages."@scope/first"]
versioned_files = [
    "first/deno.json",
    { path = "deno.lock", dependency = "@scope/first" },
]
scopes = ["@scope/first"]

[packages."@scope/second"]
versioned_files = [
    "packages/second/deno.json",
    { path = "deno.lock", dependency = "@scope/second" },
    { path = "first/deno.json", dependency = "@scope/second" },
]
scopes = ["@scope/second"]
```

If a member also has a `package.json` with a version, Knope adds that file to the relevant package and keeps
`deno.lock` entries aligned for both the Deno and Node manifests.

## Workflows

When there are no workflows defined in a `knope.toml` file, Knope will use the default workflows.
Some pieces will differ depending on the configured packages and forges:

```toml title="knope.toml" {"Does not use a $version variable when there are multiple packages": 11-13} {"Moves git push down here and pushes tags if no forges are configured": 22} {"Omits "get-version" when there are multiple packages": 30-40}
[[workflows]]
name = "release"

[[workflows.steps]]
type = "PrepareRelease"

[[workflows.steps]]
type = "Command"
command = "git commit -m \"chore: prepare release $version\""

[[workflows.steps]]
type = "Command"
command = "git push"

[[workflows.steps]]
type = "Release"



[[workflows]]
name = "document-change"

[[workflows.steps]]
type = "CreateChangeFile"


[[workflows]]
name = "get-version"
help_text = "Get the current version of the project"

[[workflows.steps]]
type = "Command"
command = "echo \"$version\""
```

## Forges

If there is a `knope.toml` file, **no forges will be configured by default**.
If there is _no_ `knope.toml` file, Knope will look at the first Git remote to determine a forge config.

For example, if the first Git remote is `git@github.com:knope-dev/knope.git`, Knope will generate a GitHub config:

```toml title="knope.toml"
[github]
owner = "knope-dev"
repo = "knope"
```

See [forges](/reference/concepts/forge) for more info.
